<div class="user-orders">
  <h2 class="section-title">Đơn hàng của tôi</h2>
  <p class="section-subtitle">Quản lý và theo dõi đơn hàng</p>

  <!-- Loading State -->
  <div *ngIf="isLoading" class="loading-state">
    <div class="spinner"></div>
    <p>Đang tải đơn hàng...</p>
  </div>

  <!-- Error State -->
  <div *ngIf="errorMessage && !isLoading" class="error-state">
    <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2">
      <circle cx="12" cy="12" r="10"></circle>
      <line x1="12" y1="8" x2="12" y2="12"></line>
      <line x1="12" y1="16" x2="12.01" y2="16"></line>
    </svg>
    <p>{{ errorMessage }}</p>
    <button class="btn-retry" (click)="loadUserOrders()">Thử lại</button>
  </div>

  <!-- Orders List -->
  <div class="orders-list" *ngIf="!isLoading && !errorMessage">
    <div *ngFor="let order of orders" class="order-card">
      <div class="order-header">
        <div class="order-info">
          <div class="order-id">#{{ order.orderNumber || order.orderId }}</div>
          <div class="order-date">{{ formatDate(order.orderDate) }}</div>
        </div>
        <div class="order-status" [ngClass]="getStatusClass(order)">
          <span class="status-dot"></span>
          {{ getStatusDisplay(order) }}
        </div>
      </div>

      <div class="order-items">
        <div *ngFor="let item of order.items" class="order-item">
          <div class="item-name">{{ item.productName }}</div>
          <div class="item-details">
            <span>Số lượng: {{ item.quantity }}</span>
            <span>{{ formatPrice(item.unitPrice) }}</span>
          </div>
        </div>
        <div *ngIf="!order.items || order.items.length === 0" class="order-item">
          <div class="item-name">Đơn hàng có sản phẩm</div>
        </div>
      </div>

      <div class="order-footer">
        <div class="order-total">
          Tổng cộng: <strong>{{ formatPrice(order.totalAmount) }}</strong>
        </div>
        <div class="order-actions">
          <button class="btn-action" (click)="viewOrderDetail(order)">Chi tiết</button>
          <button class="btn-action btn-primary" (click)="reorder(order)">Mua lại</button>
          <button *ngIf="canCancelOrder(order)" class="btn-action btn-danger" (click)="cancelOrder(order)">
            Hủy đơn
          </button>
          <button *ngIf="canExportInvoice(order)" class="btn-action btn-invoice" (click)="exportInvoice(order)"
            [disabled]="isExporting" title="Xuất hóa đơn PDF">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none"
              stroke="currentColor" stroke-width="2">
              <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
              <polyline points="14 2 14 8 20 8"></polyline>
              <line x1="16" y1="13" x2="8" y2="13"></line>
              <line x1="16" y1="17" x2="8" y2="17"></line>
              <polyline points="10 9 9 9 8 9"></polyline>
            </svg>
            {{ isExporting ? 'Đang xuất...' : 'Xuất hóa đơn' }}
          </button>
        </div>
      </div>
    </div>

    <!-- Empty State -->
    <div *ngIf="orders.length === 0" class="empty-state">
      <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none"
        stroke="currentColor" stroke-width="2">
        <polyline points="9 11 12 14 22 4"></polyline>
        <path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"></path>
      </svg>
      <p>Chưa có đơn hàng nào</p>
    </div>
  </div>
</div>